#!/usr/bin/env ruby

require 'fileutils'

ROOT_PATH = File.expand_path("#{__dir__}/../src")
BUILD_LOCATION = File.expand_path("#{__dir__}/../.package")

FileUtils.rm_rf(BUILD_LOCATION) if File.exist?(BUILD_LOCATION)
FileUtils.mkdir(BUILD_LOCATION)

Dir.glob(ROOT_PATH + '/**/*.bf').each do |file|
  output = BUILD_LOCATION + file.gsub(ROOT_PATH, '').gsub(/\.bf$/, '.swift')
  FileUtils.mkdir_p(File.dirname(output)) unless File.exist?(File.dirname(output))
  content = `#{__dir__}/Fucker file://#{file}`
  File.open(output, 'w') do |f|
    f.write(content)
  end
end
